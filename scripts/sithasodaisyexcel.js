
/* sithasodaisyexcel */
function banano_sithasodaisyexcel_sduiexcel() {var _B=this;_B.__47b=null;_B._oxml=null;_B._xlsx=null;_B.__47e=[];_B.__47f=[];_B.__480="";_B.__497="thick";_B.__498="none";_B.__499="thin";_B.__49a="medium";_B.__49b="dashed";_B.__49c="dotted";_B.__49d="double";_B.__49e="hair";_B.__49f="mediumDashed";_B.__4a0="dashDot";_B.__4a1="mediumDashDot";_B.__4a2="dashDotDot";_B.__4a3="mediumDashDotDot";_B.__4a4="slantDashDot";_B.__4a5="F44336";_B.__4a6="E91E63";_B.__4a7="9C27B0";_B.__4a8="673AB7";_B.__4a9="3F51B5";_B.__4aa="2196F3";_B.__4ab="03A9F4";_B.__4ac="00BCD4";_B.__4ad="009688";_B.__4ae="4CAF50";_B.__4af="8BC34A";_B.__4b0="CDDC39";_B.__4b1="ffe821";_B.__4b2="FFC107";_B.__4b3="FF9800";_B.__4b4="FF5722";_B.__4b5="795548";_B.__4b6="9E9E9E";_B.__4b7="607D8B";_B.__4b8="000000";_B.__4b9="ffffff";_B.__4ba="transparent";_B.__4bb="darkDown";_B.__4bc="darkGray";_B.__4bd="darkGrid";_B.__4be="darkHorizontal";_B.__4bf="darkTrellis";_B.__4c0="darkUp";_B.__4c1="darkVertical";_B.__4c2="gray0625";_B.__4c3="gray125";_B.__4c4="lightDown";_B.__4c5="lightGray";_B.__4c6="lightGrid";_B.__4c7="lightHorizontal";_B.__4c8="lightTrellis";_B.__4c9="lightUp";_B.__4ca="lightVertical";_B.__4cb="mediumGray";_B.__4cc="none";_B.__4cd="solid";_B.__1dd={};_B._rows=[];_B.__27={};_B.__4ce="";_B.initialize=function(__5c6,__5c7,__358) {_B.__27=__5c6;_B.__4ce=__5c7;;;;_B._oxml=oxml;_B.__47b=_B._oxml["xlsx"]();_B.__480=__358;_B.__1dd={};_B._rows.length=0;};_B.addcolumn=function(__8f4,__9ae) {_B.__1dd[__8f4]=__9ae;};_B.addcolumns=function(_ws,_m) {var _k,_v;var _kKeys = Object.keys(_m);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_m[_k];_B.addcolumn(_k,_v,_B);}_B.setcolumns(_ws,1,_B);};_B.clearcolumns=function() {_B.__1dd={};};_B.clearrows=function() {_B._rows.length=0;};_B.setheaderfields=function(_flds) {var __9b0,_fldcnt,__7a0;__9b0=_flds.length-1;__9b1=0;for (_fldcnt=0;_fldcnt<=__9b0;_fldcnt++) {__7a0=_flds[_fldcnt];_B.addcolumn(__7a0,__7a0,_B);}};_B.setheadertitles=function(_flds) {var __9b0,_fldcnt,__7a0;__9b0=_flds.length-1;__9b1=0;for (_fldcnt=0;_fldcnt<=__9b0;_fldcnt++) {__7a0=_flds[_fldcnt];_B.addcolumn(__7a0,__7a0,_B);}};_B.setcolumns=function(__9b2,__900) {var __9b3,_colcnt,__728,__9b4;__9b3=[];__9b3.length=0;__727=0;__728=Object.keys(_B.__1dd).length-1;for (_colcnt=0;_colcnt<=__728;_colcnt++) {__9b4=banano_getB4JValueAt(_B.__1dd,_colcnt);__9b3.push(__9b4);}_B.setrow(__9b2,__900,1,__9b3,_B);};_B.setrowsfromdatatable=function(_recs) {var _reccnt,__870,__9b5,__9b6,_hdrn,_v;__871=0;__870=_recs.length-1;for (_reccnt=0;_reccnt<=__870;_reccnt++) {__9b5=_recs[_reccnt];__9b6=[];__9b6.length=0;var _hdrnKeys = Object.keys(_B.__1dd);for (var _hdrnindex=0;_hdrnindex<_hdrnKeys.length;_hdrnindex++) {_hdrn=_hdrnKeys[_hdrnindex];_hdrn=_hdrn.toLowerCase();_v=__9b5[_hdrn];_v=_B.cstr(_v,_B);_v=_v.trim();__9b6.push(_v);}_B._rows.push(__9b6);}};_B.setcolumnsfromdatatable=function(__9b7) {var __9b8,__728,_colcnt,_hdr,__9b9,__19f;__9b8=[];__9b8.length=0;__728=Object.keys(__9b7).length-1;__727=0;for (_colcnt=0;_colcnt<=__728;_colcnt++) {_hdr=banano_getB4JValueAt(__9b7,_colcnt);__9b9=_hdr.__d0;__19f=_hdr.__c0;switch ("" + _hdr.__397) {case "" + "action":case "" + "edit":case "" + "delete":case "" + "print":case "" + "delete":case "" + "clone":case "" + "save":case "" + "cancel":case "" + "button":case "" + "menu":break;default:_B.__1dd[__9b9]=__19f;break;}}};_B.cstr=function(_o) {if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};_B.readfromarraybuffer=function(_data) {var _opt;;_B.__1dd={};_B._rows.length=0;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__47b=_B._xlsx["read"](_data,_opt);_B.__47e=_B.__47b["SheetNames"];_B.__47f=_B.__47b["Sheets"];};_B.readsheetcontentsbypos=function(_pos) {var __9ba,__9b2,__9bb,__9bc;__9ba=_B.__47e[_pos];__9b2=_B.__47f[__9ba];__9bb={};__9bb["defval"]="";__9bb["dateNF"]="yyyy-mm-dd hh:mm:ss";__9bc=_B._xlsx["utils"]["sheet_to_row_object_array"](__9b2,__9bb);return __9bc;};_B.getsinglecode=function(_lst) {var __9bd,__9be,__9bf,_r1,_k,_nk;__9bd=new StringBuilder();__9bd.init();__9bd.isinitialized=true;__9be=new StringBuilder();__9be.init();__9be.isinitialized=true;__9bd.append("'create a new record").append("\n");__9bd.append("Dim item As Map").append("\n");__9bd.append("item.Initialize").append("\n");__9bf=new StringBuilder();__9bf.init();__9bf.isinitialized=true;__9bf.append("For Each r As Map In records").append("\n");_r1=_lst[0];var _kKeys = Object.keys(_r1);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_nk=_banano_sithasodaisy_sduishared.alphanumeric(_k);_nk=_nk.trim();__9bf.append("Dim s" + _nk + " As String = r.GetDefault(\"" + _k + "\", \"\")").append("\n");__9bd.append("item.put(\"" + _nk + "\", s" + _nk + ")").append("\n");__9be.append("s" + _nk + " = SDUIShared.CStr(s" + _nk + ")").append("\n");__9be.append("s" + _nk + " = s" + _nk + ".Trim").append("\n");}__9bf.append(__9be.toString());__9bf.append(__9bd.toString());__9bf.append("Next").append("\n");return __9bf.toString();};_B.readfile=function(_data) {var _BANp = gBANp(arguments);var _opt,__9ba,__9b2,__9bb,__9bc;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__47b=_B._xlsx["read"](_data,_opt);_B.__47e=_B.__47b["SheetNames"];__9ba=_B.__47e[0];_B.__47f=_B.__47b["Sheets"];__9b2=_B.__47f[__9ba];__9bb={};__9bb["defval"]="";__9bb["dateNF"]="yyyy-mm-dd hh:mm:ss";__9bc=_B._xlsx["utils"]["sheet_to_row_object_array"](__9b2,__9bb);return __9bc;};_B.readfileworksheet=function(_data,_ws) {var _xlsx,_opt,__9ba,__9b2,__9bb,__9bc;_xlsx=null;_xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__47b=_xlsx["read"](_data,_opt);_B.__47e=_B.__47b["SheetNames"];__9ba=_B.__47e[_ws];_B.__47f=_B.__47b["Sheets"];__9b2=_B.__47f[__9ba];__9bb={};__9bb["defval"]="";__9bb["dateNF"]="yyyy-mm-dd hh:mm:ss";__9bc=_xlsx["utils"]["sheet_to_row_object_array"](__9b2,__9bb);return __9bc;};_B.createstyle=function() {var _s;_s= new banano_sithasodaisyexcel_oxmlstyle();_s.initialize();_s._bold=false;_s.__487=false;_s.__488=false;_s.__489=false;_s.__48a=false;_s.__48b="";_s.__48c="";_s.__48d="";_s.__48e="";_s.__48f="";_s.__490="";_s.__492="";_s.__493="";_s.__494="";_s.__495="";_s.__496="";return _s;};_B.setstyleborder=function(_rc,__490,__491) {var __9c1,_obj;__9c1={};__9c1["color"]=__490;__9c1["style"]=__491;_obj={};_obj["border"]=__9c1;_rc["style"](_obj);return _B;};_B.setstylenumberformat=function(_rc,_nf) {var _obj;_obj={};_obj["numberFormat"]=_nf;_rc["style"](_obj);return _B;};_B.setstylebold=function(_rc,_b) {var _obj;_obj={};_obj["bold"]=_b;_rc["style"](_obj);return _B;};_B.setstyleitalic=function(_rc,_b) {var _obj;_obj={};_obj["italic"]=_b;_rc["style"](_obj);return _B;};_B.setstyleunderline=function(_rc,_b) {var _obj;_obj={};_obj["underline"]=_b;_rc["style"](_obj);return _B;};_B.setstylefontsize=function(_rc,_fs) {var _obj;_obj={};_obj["fontSize"]=_fs;_rc["style"](_obj);return _B;};_B.setstylevalignment=function(_rc,_va) {var _obj;_obj={};_obj["vAlignment"]=_va;_rc["style"](_obj);return _B;};_B.setstylehalignment=function(_rc,_ha) {var _obj;_obj={};_obj["hAlignment"]=_ha;_rc["style"](_obj);return _B;};_B.setstyle=function(_rc,__482) {var _obj,__9c1,_fill;_obj={};if (__482._bold) {_obj["bold"]=__482._bold;}if (__482.__487) {_obj["italic"]=__482.__487;}if (__482.__488) {_obj["underline"]=__482.__488;}if (__482.__489) {_obj["strike"]=__482.__489;}if (__482.__48a) {_obj["fontSize"]=__482.__48a;}if (__482.__48b!="") {_obj["fontColor"]=__482.__48b;}if (__482.__48c!="") {_obj["fontName"]=__482.__48c;}if (__482.__48d!="") {_obj["fontFamily"]=__482.__48d;}if (__482.__48e!="") {_obj["scheme"]=__482.__48e;}if (__482.__48f!="") {_obj["numberFormat"]=__482.__48f;}if (__482.__493!="") {_obj["vAlignment"]=__482.__493;}if (__482.__492!="") {_obj["hAlignment"]=__482.__492;}if (__482.__490!="" || __482.__491!="") {__9c1={};__9c1["color"]=__482.__490;__9c1["style"]=__482.__491;_obj["border"]=__9c1;}if (__482.__494!="" && __482.__495!="" && __482.__496!="") {_fill={};_fill["pattern"]=__482.__494;_fill["foreColor"]=__482.__495;_fill["backColor"]=__482.__496;_obj["fill"]=_fill;}_rc["style"](_obj);};_B.merge=function(__9b2,__3a5) {__9b2["merge"](__3a5);return _B;};_B.getrow=function(__9b2,__900,__905) {var _row;_row=__9b2["row"](__900,__905);return _row;};_B.getcolumn=function(__9b2,__900,__905) {var _colx;_colx=__9b2["column"](__900,__905);return _colx;};_B.getcell=function(__9b2,__900,__905) {var _colx;_colx=__9b2["cell"](__900,__905);return _colx;};_B.createrow=function(__900,__905) {var _row;_row= new banano_sithasodaisyexcel_oxmlrow();_row.initialize();_row.__484=__905;_row.__483=__900;_row.__485.length=0;_row.__482={};return _row;};_B.createformula=function(__481) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__397="formula";_cell.__481=__481;_cell.__482={};return _cell;};_B.createtext=function(__bf) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__397="string";_cell.__bf=__bf;_cell.__482={};return _cell;};_B.createnumber=function(__bf) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__397="numeric";_cell.__bf=__bf;_cell.__482={};return _cell;};_B.createsharedtext=function(__bf) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__397="sharedString";_cell.__bf=__bf;_cell.__482={};return _cell;};_B.cell2map=function(_cell) {var _m;_m={};_m["type"]=_cell.__397;_m["value"]=_cell.__bf;if (_cell.__481!="") {_m["formula"]=_cell.__481;}return _m;};_B.worksheet=function(__9c9) {var __9ca;__9ca=null;__9ca=_B.__47b["sheet"](__9c9);return __9ca;};_B.addworksheet=function(__9c9) {var _bo;_bo=_B.worksheet(__9c9,_B);return _bo;};_B.setrow=function(__9b2,__900,__905,__485) {__9b2["row"](__900,__905,__485);};_B.setcolumn=function(__9b2,__900,__905,__485) {__9b2["column"](__900,__905,__485);};_B.setrowbo=function(_row,__485) {_row["set"](__485);};_B.setcolbo=function(_col,__485) {_col["set"](__485);};_B.setrow1=function(__9b2,_row) {var __900,__905,__485;__900=_row.__483;__905=_row.__484;__485=_row.__485;_B.setrow(__9b2,__900,__905,__485,_B);};_B.download=async function(__5c6,__5dd) {var _res,_err,_prom,_args;_res={};_err={};_prom=_B.__47b["download"](_B.__480);await _prom;_prom.then(function(_res) {_args=[];_prom=BANanoPromise();__5c6[(__5dd).toLowerCase()](_args,_prom,_B);}).catch(function(_err) {});};_B.addrowtext=function(_row,__bf) {var _cell;_cell=_B.cell2map(_B.createtext(__bf,_B),_B);_row.__485.push(_cell);return _B;};_B.addrownumber=function(_row,__bf) {var _cell;_cell=_B.cell2map(_B.createnumber(__bf,_B),_B);_row.__485.push(_cell);return _B;};_B.addrowsharedtext=function(_row,__bf) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__bf,_B),_B);_row.__485.push(_cell);return _B;};_B.addrowformula=function(_row,__481) {var _cell;_cell=_B.cell2map(_B.createformula(__481,_B),_B);_row.__485.push(_cell);return _B;};_B.addrowformula1=function(_row,__481,__bf) {var _cell,__9cc;_cell=_B.createformula(__481,_B);_cell.__bf=__bf;__9cc=_B.cell2map(_cell,_B);_row.__485.push(__9cc);return _B;};_B.settext=function(__9b2,__900,__905,__bf) {var _cell;_cell=_B.cell2map(_B.createtext(__bf,_B),_B);__9b2["cell"](__900,__905)["set"](_cell);};_B.setcelltext=function(__9cd,__bf) {var _cell;_cell=_B.cell2map(_B.createtext(__bf,_B),_B);__9cd["set"](_cell);};_B.setcellnumber=function(__9cd,__bf) {var _cell;_cell=_B.cell2map(_B.createnumber(__bf,_B),_B);__9cd["set"](_cell);};_B.setnumber=function(__9b2,__900,__905,__bf) {var _cell;_cell=_B.cell2map(_B.createnumber(__bf,_B),_B);__9b2["cell"](__900,__905)["set"](_cell);};_B.setcellsharedtext=function(__9cd,__bf) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__bf,_B),_B);__9cd["set"](_cell);};_B.setsharedtext=function(__9b2,__900,__905,__bf) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__bf,_B),_B);__9b2["cell"](__900,__905)["set"](_cell);};_B.setcellformula=function(__9cd,__481) {var _cell;_cell=_B.cell2map(_B.createformula(__481,_B),_B);__9cd["set"](_cell);};_B.setformula=function(__9b2,__900,__905,__481) {var _cell;_cell=_B.cell2map(_B.createformula(__481,_B),_B);__9b2["cell"](__900,__905)["set"](_cell);};_B.setcellformula1=function(__9cd,__481,__bf) {var _cell,__9cc;_cell=_B.createformula(__481,_B);_cell.__bf=__bf;__9cc=_B.cell2map(_cell,_B);__9cd["set"](__9cc);};_B.setformula1=function(__9b2,__900,__905,__481,__bf) {var _cell,__9cc;_cell=_B.createformula(__481,_B);_cell.__bf=__bf;__9cc=_B.cell2map(_cell,_B);__9b2["cell"](__900,__905)["set"](__9cc);};_B.exporttable=function(__9ce,__9c1,__374,__9cf,__1d3) {var _ws,__721,_rec,__9d0,_rowstart,__9d2,_rptr;_ws=_B.addworksheet("Sheet1",_B);_B.settext(_ws,1,1,__9ce,_B);_B.setrow(_ws,2,1,__9cf,_B);__721=3;for (var _recindex=0;_recindex<__1d3.length;_recindex++) {_rec=__1d3[_recindex];__9d0=_banano_sithasodaisy_sduishared.getlistfrommapkeys(_rec,__374);_B.setrow(_ws,__721,1,__9d0,_B);__721=__721+1;}if (__9c1) {__9d1=0;__9d2=_B.createstyle(_B);__9d2.__490=_B.__4b8;__9d2.__491=_B.__499;for (_rowstart=2;_rowstart<=__721;_rowstart++) {__9d2._bold=false;_rptr=_B.getrow(_ws,_rowstart,1,_B);if (_rowstart==2) {__9d2._bold=true;}_B.setstyle(_rptr,__9d2,_B);}}_B.download(_B.__27,"" + _B.__4ce + "_exceldownload",_B);};}